{"version":3,"file":"triangle.esm.js","sources":["../src/core/svg.ts","../src/lib/interface.ts","../src/core/index.ts"],"sourcesContent":["/**\n * @desc svg generator function\n */\n\ninterface IKey {\n    [key: string]: string;\n}\nexport default (tag: string, iKey: IKey = {}): SVGElement => {\n    // tslint:disable no-http-string\n    const dom: SVGElement = document.createElementNS(\n        'http://www.w3.org/2000/svg',\n        tag,\n    );\n    // tslint:enable no-http-string\n    const keys: string[] = Object.keys(iKey);\n\n    for (const i of keys) {\n        dom.setAttribute(i, iKey[i]);\n    }\n\n    return dom;\n};\n","/**\n * @desc interface collection\n */\n\n// TODO 有没有好一点的实现方式赋默认值\n\nexport interface Ishadow {\n    offsetX?: number | string;\n    offsetY?: number | string;\n    blur?: number | string;\n    spread?: number | string;\n    opacity?: number | string;\n}\nexport class Config {\n    public width: number = 10;\n    public height: number = 10;\n    public direction: dirEnum = dirEnum.down;\n    public radius: number = 5;\n    public color: string = 'black';\n    public border: string;\n    public shadow: Ishadow = {};\n    public className: string;\n\n    constructor(config: IConfig) {\n        Object.assign(this, config);\n        this.shadow = {\n            offsetX: this.shadow.offsetX || 0,\n            offsetY: this.shadow.offsetY || 2,\n            blur: this.shadow.blur || 4,\n            opacity: this.shadow.opacity || 0.2,\n        };\n    }\n}\n\nexport enum dirEnum {\n    down = 'down',\n    up = 'up',\n    left = 'left',\n    right = 'right',\n}\n\nexport interface IConfig {\n    width?: number;\n    height?: number;\n    direction?: dirEnum;\n    radius?: number;\n    color?: string;\n    border?: string;\n    shadow?: Ishadow;\n    className?: string;\n}\n\nexport interface IPoint {\n    x: number;\n    y: number;\n}\n","/**\n * @desc triangle module\n */\n\nimport svg from '@/core/svg';\nimport { Config, IConfig, IPoint } from '@/lib/interface';\n\nlet id: number = 0;\n\nexport default class Triangle {\n    public triangle: SVGSVGElement;\n    private config: IConfig;\n\n    private start: IPoint;\n    private between: IPoint;\n    private b1: IPoint;\n    private b2: IPoint;\n    private end: IPoint;\n\n    private filterId: string;\n\n    constructor(config: IConfig) {\n        // this.config = new Config(config);\n        this.filterId = `data-filter-id${new Date().getTime()}-${id}`;\n        id = id + 1;\n\n        this.update(config);\n    }\n\n    public update(config?: IConfig): void {\n        if (config) {\n            this.config = new Config(config);\n        }\n        this.getPoint();\n        this.getSVG();\n    }\n\n    private getPoint(): void {\n        const start: IPoint = {\n            x: 0,\n            y: 0,\n        };\n        const end: IPoint = {\n            x: this.config.width,\n            y: 0,\n        };\n        let between!: IPoint;\n        let b1!: IPoint;\n        let b2!: IPoint;\n        const margin: number = this.config.radius / Math.sqrt(2);\n\n        between = {\n            x: this.config.width / 2,\n            y: this.config.height,\n        };\n        b1 = {\n            x: this.config.width / 2 - margin,\n            y: this.config.height - margin,\n        };\n        b2 = {\n            x: this.config.width / 2 + margin,\n            y: this.config.height - margin,\n        };\n\n        this.start = start;\n        this.b1 = b1;\n        this.b2 = b2;\n        this.between = between;\n        this.end = end;\n    }\n\n    private getSVG(): void {\n        const path: string = `M ${this.start.x} ${this.start.y} L ${\n            this.b1.x\n        } ${this.b1.y} A ${this.config.radius} ${this.config.radius} 0 0 0 ${\n            this.b2.x\n        } ${this.b2.y} L ${this.end.x} ${this.end.y}`;\n\n        // tslint:disable no-http-string\n        const pathDom: SVGPathElement = document.createElementNS(\n            'http://www.w3.org/2000/svg',\n            'path',\n        );\n        const svgDom: SVGSVGElement = document.createElementNS(\n            'http://www.w3.org/2000/svg',\n            'svg',\n        );\n        let filterDom!: SVGElement;\n        // tslint:enable no-http-string\n\n        pathDom.setAttribute('d', path);\n        pathDom.setAttribute('fill', this.config.color);\n        svgDom.setAttribute(\n            'height',\n            `${this.between.y > 0 ? this.between.y : -this.between.y}px`,\n        );\n        svgDom.setAttribute('width', `${this.end.x}px`);\n        svgDom.setAttribute('fill', 'transparent');\n        svgDom.setAttribute('version', '1.1');\n\n        if (this.config.border) {\n            pathDom.setAttribute('stroke-width', '1');\n            pathDom.setAttribute('stroke', this.config.border);\n        }\n\n        if (this.config.shadow) {\n            filterDom = this.getFilter();\n            svgDom.appendChild(filterDom);\n            svgDom.setAttribute('filter', `url(#${this.filterId})`);\n        }\n\n        if (this.config.direction === 'up') {\n            svgDom.setAttribute('transform', 'rotate(180)');\n        } else if (this.config.direction === 'right') {\n            svgDom.setAttribute('transform', 'rotate(270)');\n        } else if (this.config.direction === 'left') {\n            svgDom.setAttribute('transform', 'rotate(90)');\n        }\n\n        if (this.config.className) {\n            svgDom.setAttribute('class', this.config.className);\n        }\n        svgDom.appendChild(pathDom);\n\n        this.triangle = svgDom;\n    }\n\n    private getFilter(): SVGElement {\n        const defs: SVGElement = svg('defs');\n        const filter: SVGElement = svg('filter', {\n            id: this.filterId,\n            x: '0',\n            y: '0',\n            width: '200%',\n            height: '200%',\n        });\n        const feOffset: SVGElement = svg('feOffset', {\n            result: 'offOut',\n            in: 'SourceAlpha',\n            dx: `${this.config.shadow.offsetX}`,\n            dy: `${this.config.shadow.offsetY}`,\n        });\n        const feColorMatric: SVGElement = svg('feColorMatrix', {\n            in: 'offOut',\n            result: 'matrixOut',\n            values:\n                '0 0 0 0 0 ' +\n                '0 0 0 0 0 ' +\n                '0 0 0 0 0 ' +\n                `0 0 0 ${this.config.shadow.opacity} 0`,\n        });\n        const feGaussianBlur: SVGElement = svg('feGaussianBlur', {\n            result: 'blurOUt',\n            in: 'matrixOut',\n            stdDeviation: `${this.config.shadow.blur}`,\n        });\n        const feBlend: SVGElement = svg('feBlend', {\n            in: 'SourceGraphic',\n            in2: 'blurOut',\n            mode: 'normal',\n        });\n\n        filter.appendChild(feOffset);\n        filter.appendChild(feColorMatric);\n        filter.appendChild(feGaussianBlur);\n        filter.appendChild(feBlend);\n        defs.appendChild(filter);\n\n        return defs;\n    }\n}\n"],"names":["tag","iKey","dom","document","createElementNS","keys","Object","i","setAttribute","config","dirEnum","down","assign","shadow","offsetX","offsetY","blur","opacity","id","filterId","Date","getTime","update","Config","getPoint","getSVG","start","end","width","between","b1","b2","margin","radius","Math","sqrt","height","path","x","y","pathDom","svgDom","filterDom","color","border","getFilter","appendChild","direction","className","triangle","defs","svg","filter","feOffset","feColorMatric","feGaussianBlur","feBlend"],"mappings":"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"}